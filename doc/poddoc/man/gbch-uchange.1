.\" Automatically generated by Pod::Man 2.25 (Pod::Simple 3.16)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "GBCH-UCHANGE 1"
.TH GBCH-UCHANGE 1 "2009-05-18" "GNUbatch Release 1" "GNUbatch Batch Scheduler"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
gbch\-uchange \- update or change user permissions
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
\&\fBgbch-uchange\fR
[ \fI\-options\fR ]
[ users ]
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
\&\fBgbch-uchange\fR is a shell tool that may be used to update the user
permissions file giving the user profiles of various users and the
operations which they may be permitted to perform within the
\&\fBGNUbatch\fR system. Alternatively the \*(L"default permissions\*(R" may be
updated. These are the permissions which are assigned by default to
new \fBGNUbatch\fR users.
.PP
Further options allow for a \*(L"password dump\*(R" file to be
maintained. This is for the benefit of NIS-type environments where
reading through most of the password database can take an unacceptably
long time, the user name and userid hash table is maintained in a file
and updated as necessary.
.PP
The invoking user must have \fIwrite admin file\fR permission.
.SH "OPTIONS"
.IX Header "OPTIONS"
Note that the order of treatment, letters and keywords described below
may be modified by editing the file \fIbtrest.help\fR \- see
\&\fIbtsyntax\fR\|(5).
.PP
The environment variable on which options are supplied is \f(CW\*(C`GBCH_UCHANGE\*(C'\fR and the
environment variable to specify the help file is \f(CW\*(C`BTRESTCONF\*(C'\fR.
.IP "\-? or +explain" 8
.IX Item "-? or +explain"
Causes a summary of the other options to be displayed without taking
further action.
.IP "\-A or +copy\-defaults" 8
.IX Item "-A or +copy-defaults"
Copy the default profile to all users \fIbefore\fR setting other
permissions on the named users (with the \fB\-u\fR option) or after
setting the defaults (with the \fB\-D\fR option).
.Sp
The privileges of the invoking user are not changed by this operation.
.IP "\-D or +set\-defaults" 8
.IX Item "-D or +set-defaults"
Indicate that the other options are to apply to the default
profile for new users.
.IP "\-d \fInum\fR or +default\-priority \fInum\fR" 8
.IX Item "-d num or +default-priority num"
Set the default job priority to \fInum\fR, which must be between 1 and
255.
.IP "\-J \fImodes\fR or +job\-mode \fImodes\fR" 8
.IX Item "-J modes or +job-mode modes"
Set the default permissions on jobs according to the format of the
\&\fImodes\fR argument.
.IP "\-l \fInum\fR or +min\-priority \fInum\fR" 8
.IX Item "-l num or +min-priority num"
Set the minimum job priority to \fInum\fR, which must be between 1 and 255.
.IP "\-M \fInum\fR or +max\-load\-level \fInum\fR" 8
.IX Item "-M num or +max-load-level num"
Set the maximum load level for any one job to \fInum\fR, which must be
between 1 and 32767.
.IP "\-m \fInum\fR or +max\-priority \fInum\fR" 8
.IX Item "-m num or +max-priority num"
Set the maximum job priority to \fInum\fR, which must be between 1 and 255.
.IP "\-N or +no\-rebuild" 8
.IX Item "-N or +no-rebuild"
Cancel the \fB\-R\fR option.
.IP "\-p \fIprivileges\fR or +privileges \fIprivileges\fR" 8
.IX Item "-p privileges or +privileges privileges"
Set the privileges of the user(s) as specified by the argument.
.IP "\-R or +rebuild\-file" 8
.IX Item "-R or +rebuild-file"
Rebuild the user permissions file \fIbtufile\fR incorporating any changes
in the password list.
.IP "\-S \fInum\fR or +special\-load\-level \fInum\fR" 8
.IX Item "-S num or +special-load-level num"
Set the special load level for the user(s) to \fInum\fR, which must be
between 1 and 32767.
.IP "\-s or +no\-copy\-defaults" 8
.IX Item "-s or +no-copy-defaults"
Cancel the effect of the \fB\-A\fR option
.IP "\-T \fInum\fR or +total\-load\-level \fInum\fR" 8
.IX Item "-T num or +total-load-level num"
Set the total load level for the user(s) to \fInum\fR, which must be
between 1 and 32767.
.IP "\-u or +set\-users" 8
.IX Item "-u or +set-users"
Indicate that the other options are to apply to the users specified on
the rest of the command line, resetting any previous \fB\-D\fR option.
.IP "\-V or +var\-mode" 8
.IX Item "-V or +var-mode"
Set the default permissions on variables according to the format of the
\&\fImodes\fR argument.
.IP "\-X or +dump\-passwd" 8
.IX Item "-X or +dump-passwd"
Dump out the hash table of the password file to avoid re-reading the
password file within the other programs.
.IP "\-Y or +default\-passwd" 8
.IX Item "-Y or +default-passwd"
Default handling of password hash file dump \- rebuild if it is already
present and \fB\-R\fR specified, otherwise not.
.IP "\-Z or +kill\-dump\-passwd" 8
.IX Item "-Z or +kill-dump-passwd"
Delete any existing dumped password hash file.
.IP "+freeze\-current" 8
.IX Item "+freeze-current"
Save all the current options in a \fI.gnubatch\fR file in the current
directory.
.IP "+freeze\-home" 8
.IX Item "+freeze-home"
Save all the current options in a \fI.gnubatch\fR file in the user's home
directory.
.SH "Users or default"
.IX Header "Users or default"
In one operation \fBgbch-uchange\fR either adjusts the default permissions,
to be applied to new users, if \fB\-D\fR is specified, or specified users,
if nothing or \fB\-u\fR is specified. So first set the required defaults:
.PP
.Vb 1
\&        gbch\-uchange \-D \-n 20 \-p CR,SPC,ST,Cdft \-A
.Ve
.PP
Then set named users
.PP
.Vb 1
\&        gbch\-uchange \-p ALL jmc root batch
.Ve
.SH "Rebuilding the user control file"
.IX Header "Rebuilding the user control file"
After adding new users to the system, you should rebuild the user
control file by running
.PP
.Vb 1
\&        gbch\-uchange \-R
.Ve
.PP
On a system with a large number of users, this can take a long time,
so the previous method of adding new users as they were encountered
meant that various hold-ups occurred in standard utilities or the
scheduler, whichever was the first to \*(L"notice\*(R" the changes, which
might, in the event, be half-complete.
.PP
We suggest that this command be added to the \*(L"add new user\*(R" procedure
for your installation.
.SH "Dumping the password file"
.IX Header "Dumping the password file"
When any of the \fBGNUbatch\fR programs which may require to map numeric
user ids to names and vice versa start, one of the first operations is
to build the appropriate hash tables. This may take some time if there
are a large number of user names, especially if \s-1NIS\s0 (a.k.a. \fIyellow
pages\fR) is in use.
.PP
A short cut is to dump out the password file into a hash table file,
by default \fIpwdump6\fR, which may be quickly read in by the relevant
programs instead of rebuilding the hash table each time.
.PP
You may opt to create the dumped password file by running
.PP
.Vb 1
\&        gbch\-uchange \-X
.Ve
.PP
This should only be done when the scheduler is stopped.
.PP
Afterwards, each time the user control file is rebuilt using the \fB\-R\fR
option (or equivalents in other programs such as \fIgbch\-user\fR\|(1)), this file
will also be rebuilt. \fB\-X\fR does not have to be specified again.
.PP
If you ever decide you want to dispense with this file, run
\&\fBgbch-uchange\fR with the \fB\-Z\fR option.
.PP
For completeness, the \fB\-Y\fR option is provided to cancel \fB\-X\fR or
\&\fB\-Z\fR in case they are provided in the environment or a \fI.gnubatch\fR
file, an extremely bad idea.
.SS "Privileges"
.IX Subsection "Privileges"
The following may be specified as the argument to \fB\-p\fR, as one or
more (comma-separated) of argument may be one or more of the following
codes, optionally preceded by a minus to turn off the corresponding
privilege.
.IP "\s-1RA\s0" 4
.IX Item "RA"
read admin file
.IP "\s-1WA\s0" 4
.IX Item "WA"
write admin file
.IP "\s-1CR\s0" 4
.IX Item "CR"
create
.IP "\s-1SPC\s0" 4
.IX Item "SPC"
special create
.IP "\s-1ST\s0" 4
.IX Item "ST"
stop scheduler
.IP "Cdft" 4
.IX Item "Cdft"
change default
.IP "\s-1UG\s0" 4
.IX Item "UG"
or user and group modes
.IP "\s-1UO\s0" 4
.IX Item "UO"
or user and other modes
.IP "\s-1GO\s0" 4
.IX Item "GO"
or group and other modes.
.PP
\&\f(CW\*(C`ALL\*(C'\fR may be used to denote all of the permissions, and then perhaps
to cancel some. For example:
.PP
.Vb 2
\&        \-p CR,ST,Cdft
\&        \-p ALL,\-WA
.Ve
.PP
A hexadecimal value is also accepted, but this is intended only for
the benefit of the installation routines.
.SS "Mode arguments"
.IX Subsection "Mode arguments"
The argument to the \fB\-J\fR and \fB\-V\fR options provides for a wide variety of
operations.
.PP
Each permission is represented by a letter, as follows:
.IP "R" 4
.IX Item "R"
read permission
.IP "W" 4
.IX Item "W"
write permission
.IP "S" 4
.IX Item "S"
reveal permission
.IP "M" 4
.IX Item "M"
read mode
.IP "P" 4
.IX Item "P"
set mode
.IP "U" 4
.IX Item "U"
give away owner
.IP "V" 4
.IX Item "V"
assume owner
.IP "G" 4
.IX Item "G"
give away group
.IP "H" 4
.IX Item "H"
assume group
.IP "D" 4
.IX Item "D"
delete
.IP "K" 4
.IX Item "K"
kill (only valid for jobs)
.PP
Each section of the mode (job, group, others) is represented by the
prefixes \f(CW\*(C`U:\*(C'\fR, \f(CW\*(C`G:\*(C'\fR and \f(CW\*(C`O:\*(C'\fR and separated by commas.
.PP
For example:
.PP
.Vb 1
\&        \-J U:RWSMPDK,G:RWSDK,O:RS
.Ve
.PP
would set the permissions for the user, group and others as given. If
the prefixes are omitted, as in
.PP
.Vb 1
\&        \-J RWSDK
.Ve
.PP
then all of the user, group and other permissions are set to the same
value. Alternatively two of the \f(CW\*(C`J\*(C'\fR, \f(CW\*(C`G\*(C'\fR or \f(CW\*(C`O\*(C'\fR may be run together
as in
.PP
.Vb 1
\&        \-J U:RWSKD,GO:RWS
.Ve
.PP
if \*(L"group\*(R" or \*(L"other\*(R" (in this case) are to have the same permissions.
.SH "FILES"
.IX Header "FILES"
\&\fI~/.gnubatch\fR
configuration file (home directory)
.PP
\&\fI.gnubatch\fR
configuration file (current directory)
.PP
\&\fIbtrest.help\fR
message file
.PP
\&\fIbtufile\fR
user permissions file
.PP
\&\fIpwdump\fR
saved password file
.SH "ENVIRONMENT"
.IX Header "ENVIRONMENT"
.IP "\s-1GBCH_UCHANGE\s0" 4
.IX Item "GBCH_UCHANGE"
space-separated options to override defaults.
.IP "\s-1BTRESTCONF\s0" 4
.IX Item "BTRESTCONF"
location of alternative help file.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fIgbch\-ulist\fR\|(1),
\&\fIgbch\-user\fR\|(1),
\&\fIbtsyntax\fR\|(5).
.SH "DIAGNOSTICS"
.IX Header "DIAGNOSTICS"
Various diagnostics are read and printed as required from the message
file \fIbtrest.help\fR.
.SH "COPYRIGHT"
.IX Header "COPYRIGHT"
Copyright (c) 2009 Free Software Foundation, Inc.
This is free software. You may redistribute copies of it under the
terms of the \s-1GNU\s0 General Public License
<http://www.gnu.org/licenses/gpl.html>.
There is \s-1NO\s0 \s-1WARRANTY\s0, to the extent permitted by law.
.SH "AUTHOR"
.IX Header "AUTHOR"
John M Collins, Xi Software Ltd.
