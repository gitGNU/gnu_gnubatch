.\" Automatically generated by Pod::Man 2.25 (Pod::Simple 3.16)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "BTSCHED 8"
.TH BTSCHED 8 "2009-05-18" "GNUbatch Release 1" "GNUbatch Batch Scheduler"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
btsched \- batch scheduler
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
\&\fBbtsched\fR
[ \fI\-options\fR ]
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
\&\fBbtsched\fR is the scheduler process for the \fBGNUbatch\fR batch
processing system.
.PP
It is normally invoked by the system startup routines, or otherwise by
\&\fIgbch\-start\fR\|(1).
.PP
It may take certain options from the command line, but these are
normally passed to it by \fIgbch\-start\fR\|(1) and are not documented here as
they are part of the internal interfaces of \fBGNUbatch\fR and are
subject to change.
.PP
Information, either in respect of other machines to connect
to, or pre-existing jobs and variables on the current machine, are
read respectively from the files \fIgnubatch.hosts\fR and the spool directory.
.PP
A \*(L"slave\*(R" \fBbtsched\fR process is spawned to control running jobs, and
if a networked version of \fBGNUbatch\fR is being run, then an additional
\&\*(L"slave\*(R" \fBbtsched\fR process is spawned to monitor and process incoming
network messages.
.PP
Incoming remotely-submitted jobs and \s-1API\s0 interfaces are handled via a
separate process (also invoked by \fIgbch\-start\fR\|(1)), \fIxbnetserv\fR\|(8).
.SH "FILES"
.IX Header "FILES"
\&\fIgnubatch.hosts\fR
host names and descriptions
.PP
\&\fIgnubatch.conf\fR
master configuration file
.PP
\&\fIbtint-config\fR
message file
.PP
\&\fIbtsched_jfile\fR
job file
.PP
\&\fIbtsched_vfile\fR
variables file
.PP
\&\fIbtsched_reps\fR
error log file
.PP
\&\fIbtufile\fR
user data
.PP
\&\fIbtmm_jobs\fR
job memory-mapped file
.PP
\&\fIbtmm_vars\fR
variables memory-mapped file
.PP
\&\fIbtmm_xfer\fR
communication buffer memory-mapped file
.SH "ENVIRONMENT"
.IX Header "ENVIRONMENT"
.IP "\s-1SPOOLDIR\s0" 4
.IX Item "SPOOLDIR"
alternative location for spool directory
.SH "IPC FACILITIES"
.IX Header "IPC FACILITIES"
An \s-1IPC\s0 message queue, with key \f(CW0x5869b000\fR and owned by user \fIbatch\fR
is created by \fBbtsched\fR and used to receive messages from user
processes and pass instructions to and internal messages from the
slave \fBbtsched\fR processes to the master.
.PP
Two shared memory segments are created to hold details of jobs and
variables. As the shared memory facility provides no facilities for
growth, then additional shared memory segments may be created if the
job and variable lists expand sufficiently and the original ones
deallocated.
.PP
A further shared memory segment, with key \f(CW0x5869b100\fR is created to
hold details of pending jobs before transfer to the main shared memory
segment.
.PP
The keys given to the shared memory segments start at \f(CW0x5869b002\fR
and ascend upwards to \f(CW0x5869b064\fR before wrapping around.
.PP
Some versions of \fBbtsched\fR may use memory-mapped files rather than
shared memory. The files are held in the spool directory and have the
names \fIbtmm_jobs\fR, \fIbtmm_vars\fR and \fIbtmm_xfer\fR.
.PP
A set of 10 semaphores, with the key \f(CW0x5869b001\fR is created to
interlock access to the shared memory segments, and a further set of 3
semaphores with the key \f(CW0x5869b003\fR is created to interlock network
processes.
.PP
The presence or absence of these \s-1IPC\s0 facilities is used by \fBbtsched\fR
and other programs to determine whether a previous copy of itself is
running. If \fBbtsched\fR is abnormally terminated, it may be necessary
to delete these \s-1IPC\s0 facilities before \fBbtsched\fR can be restarted.
.PP
The utility \fIgbch\-ripc\fR\|(8) may be used to delete the \s-1IPC\s0 facilities quickly.
.SH "INTERNET PORTS"
.IX Header "INTERNET PORTS"
\&\fBbtsched\fR accepts and sends interconnections from other machines on
\&\s-1TCP\s0 port, passes the contents of batch jobs on a further \s-1TCP\s0 port, and
undertakes \*(L"probes\*(R" on a \s-1UDP\s0 port.
.PP
The port numbers are set up in the \fI/etc/services\fR file when
\&\fBGNUbatch\fR is first installed.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fIgbch\-r\fR\|(1),
\&\fIgbch\-q\fR\|(1),
\&\fIgbch\-var\fR\|(1),
\&\fIgbch\-jlist\fR\|(1),
\&\fIgbch\-vlist\fR\|(1),
\&\fIgbch\-start\fR\|(1),
\&\fIgbch\-quit\fR\|(1),
\&\fIgbch\-ripc\fR\|(8),
\&\fIgnubatch.conf\fR\|(5),
(5),
\&\fIxbnetserv\fR\|(8).
.SH "DIAGNOSTICS"
.IX Header "DIAGNOSTICS"
\&\fBbtsched\fR is usually invoked from system startup procedures or
\&\fIgbch\-start\fR\|(1).
.PP
Thereafter it runs as a \*(L"daemon process\*(R" and diagnostics are not
written to any terminal but to the file \fIbtsched_reps\fR.
.PP
In the event of any problems this file should be examined.
.SH "COPYRIGHT"
.IX Header "COPYRIGHT"
Copyright (c) 2009 Free Software Foundation, Inc.
This is free software. You may redistribute copies of it under the
terms of the \s-1GNU\s0 General Public License
<http://www.gnu.org/licenses/gpl.html>.
There is \s-1NO\s0 \s-1WARRANTY\s0, to the extent permitted by law.
.SH "AUTHOR"
.IX Header "AUTHOR"
John M Collins, Xi Software Ltd.
